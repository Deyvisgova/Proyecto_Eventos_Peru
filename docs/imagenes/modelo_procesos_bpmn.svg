<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="680" viewBox="0 0 1100 680" role="img" aria-labelledby="title desc">
  <title id="title">Modelo de Procesos (BPMN) - Compra de entradas</title>
  <desc id="desc">Proceso BPMN para compra de entradas de un evento con tareas del cliente, backend y pasarela de pago.</desc>
  <defs>
    <style>
      text { font-family: 'Inter', 'Segoe UI', Arial, sans-serif; }
      .lane { fill: #f8fafc; stroke: #cbd5e1; }
      .task { fill: #eef2ff; stroke: #6366f1; stroke-width: 2; rx: 12; ry: 12; }
      .task2 { fill: #ecfdf3; stroke: #22c55e; stroke-width: 2; rx: 12; ry: 12; }
      .task3 { fill: #fff7ed; stroke: #f97316; stroke-width: 2; rx: 12; ry: 12; }
      .gateway { fill: #f1f5f9; stroke: #0f172a; stroke-width: 2; }
      .event { fill: #0ea5e9; stroke: #0284c7; stroke-width: 3; }
      .text-sm { font-size: 14px; }
      .text-md { font-size: 16px; font-weight: 700; }
    </style>
    <marker id="arrow" markerWidth="12" markerHeight="12" refX="6" refY="6" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L12,6 L0,12 z" fill="#0f172a" />
    </marker>
  </defs>

  <rect x="0" y="0" width="1100" height="680" fill="#f8f9fb" />
  <text x="550" y="40" text-anchor="middle" class="text-md" font-size="24">BPMN - Compra de entradas</text>
  <text x="550" y="66" text-anchor="middle" class="text-sm" fill="#475569">Flujo coordinado entre cliente, backend y pasarela de pago</text>

  <!-- Lanes -->
  <g>
    <rect x="30" y="90" width="1040" height="160" class="lane" />
    <text x="45" y="110" class="text-md" fill="#0ea5e9">Cliente (web/mobile)</text>
    <rect x="30" y="270" width="1040" height="160" class="lane" />
    <text x="45" y="290" class="text-md" fill="#22c55e">Backend (API)</text>
    <rect x="30" y="450" width="1040" height="160" class="lane" />
    <text x="45" y="470" class="text-md" fill="#f97316">Pasarela de pago</text>
  </g>

  <!-- Start event -->
  <circle cx="100" cy="180" r="24" class="event" fill="#22d3ee" />
  <text x="100" y="185" text-anchor="middle" class="text-sm" fill="#fff">Inicio</text>

  <!-- Cliente tasks -->
  <rect x="160" y="145" width="170" height="70" class="task" />
  <text x="245" y="185" text-anchor="middle" class="text-sm">Selecciona evento / fecha</text>

  <rect x="360" y="145" width="170" height="70" class="task" />
  <text x="445" y="182" text-anchor="middle" class="text-sm">Escoge asientos y cantidad</text>

  <rect x="560" y="145" width="170" height="70" class="task" />
  <text x="645" y="175" text-anchor="middle" class="text-sm">Confirma datos</text>
  <text x="645" y="195" text-anchor="middle" class="text-sm">y crea orden</text>

  <!-- Gateway before pago -->
  <polygon points="780,180 820,145 860,180 820,215" class="gateway" />
  <text x="820" y="185" text-anchor="middle" class="text-sm">Pago</text>

  <!-- End event cliente -->
  <circle cx="980" cy="180" r="24" class="event" fill="#16a34a" />
  <text x="980" y="185" text-anchor="middle" class="text-sm" fill="#fff">Ticket</text>

  <!-- Backend tasks -->
  <rect x="200" y="320" width="190" height="70" class="task2" />
  <text x="295" y="350" text-anchor="middle" class="text-sm">API reserva aforo</text>
  <text x="295" y="370" text-anchor="middle" class="text-sm">(lock seats)</text>

  <rect x="420" y="320" width="200" height="70" class="task2" />
  <text x="520" y="352" text-anchor="middle" class="text-sm">Genera orden y totales</text>
  <text x="520" y="372" text-anchor="middle" class="text-sm">+ URL de pago</text>

  <rect x="660" y="320" width="200" height="70" class="task2" />
  <text x="760" y="352" text-anchor="middle" class="text-sm">Recibe webhook</text>
  <text x="760" y="372" text-anchor="middle" class="text-sm">y confirma pago</text>

  <rect x="900" y="320" width="140" height="70" class="task2" />
  <text x="970" y="352" text-anchor="middle" class="text-sm">Emite ticket</text>
  <text x="970" y="372" text-anchor="middle" class="text-sm">+ email/QR</text>

  <!-- Pasarela -->
  <rect x="450" y="500" width="200" height="70" class="task3" />
  <text x="550" y="532" text-anchor="middle" class="text-sm">Autenticación</text>
  <text x="550" y="552" text-anchor="middle" class="text-sm">y cobro</text>

  <!-- Flows -->
  <path d="M124 180 L160 180" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <path d="M330 180 L360 180" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <path d="M530 180 L560 180" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <path d="M730 180 L780 180" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <path d="M860 180 L956 180" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />

  <!-- Vertical handoffs -->
  <path d="M645 215 L645 320" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <text x="655" y="270" class="text-sm" fill="#0f172a">POST /orden</text>

  <path d="M520 215 L520 320" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <text x="500" y="270" class="text-sm" fill="#0f172a">Reserva</text>

  <path d="M820 215 L820 320" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <text x="840" y="270" class="text-sm" fill="#0f172a">Checkout URL</text>

  <path d="M760 390 L760 500" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <text x="778" y="450" class="text-sm" fill="#0f172a">Redirección</text>

  <path d="M550 500 L550 390" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <text x="568" y="455" class="text-sm" fill="#0f172a">Webhook</text>

  <path d="M970 390 L970 215" stroke="#0f172a" stroke-width="2.5" marker-end="url(#arrow)" />
  <text x="982" y="300" class="text-sm" fill="#0f172a">Ticket + QR</text>
</svg>
